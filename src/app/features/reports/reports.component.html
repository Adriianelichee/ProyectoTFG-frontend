<div class="reports-container">
  <div class="reports-header">
    <div class="title-section">
      <h1>Reportes de Incidencias</h1>
      <p class="subtitle">Gestión de reportes de problemas</p>
    </div>
    <div class="action-section">
      <button class="btn-primary" routerLink="/reports/new">
        <i class="fas fa-plus"></i> Nuevo Reporte
      </button>
    </div>
  </div>

  <!-- Panel de filtros -->
  <div class="filters-panel">
    <h3><i class="fas fa-filter"></i> Filtros</h3>

    <form [formGroup]="filterForm" class="filter-form">
      <div class="filter-group">
        <label for="specialty">Especialidad</label>
        <div class="select-wrapper">
          <select id="specialty" formControlName="specialty">
            <option value="">Todas las especialidades</option>
            <option value="maintenance">Mantenimiento</option>
            <option value="cleaning">Limpieza</option>
            <option value="security">Seguridad</option>
            <option value="technology">Tecnología</option>
          </select>
          <i class="fas fa-chevron-down"></i>
        </div>
      </div>

      <div class="filter-group">
        <label for="status">Estado</label>
        <div class="select-wrapper">
          <select id="status" formControlName="status">
            <option value="">Todos los estados</option>
            <option value="pending">Pendiente</option>
            <option value="in_progress">En progreso</option>
            <option value="resolved">Resuelto</option>
          </select>
          <i class="fas fa-chevron-down"></i>
        </div>
      </div>

      <button type="button" class="btn-outline" (click)="resetFilters()">
        <i class="fas fa-undo"></i> Reiniciar
      </button>
    </form>
  </div>

  <!-- Mensaje de error -->
  <div class="error-alert" *ngIf="errorMessage">
    <i class="fas fa-exclamation-triangle"></i>
    <span>{{ errorMessage }}</span>
  </div>

  <!-- Indicador de carga -->
  <div class="loading-indicator" *ngIf="isLoading">
    <i class="fas fa-spinner fa-spin"></i> Cargando reportes...
  </div>

  <!-- Sin resultados -->
  <div class="no-results" *ngIf="!isLoading && filteredReports.length === 0">
    <i class="fas fa-search"></i>
    <p>No se encontraron reportes con los criterios seleccionados</p>
  </div>

  <!-- Tabla de reportes -->
  <div class="reports-table-container" *ngIf="!isLoading && filteredReports.length > 0">
    <table class="reports-table">
      <thead>
      <tr>
        <th>ID</th>
        <th>Fecha</th>
        <th>Ubicación</th>
        <th>Estado</th>
        <th>Acciones</th>
      </tr>
      </thead>
      <tbody>
      <tr *ngFor="let report of filteredReports">
        <td class="report-id">{{ report.reportId }}</td>
        <td class="report-date">{{ formatDate(report.reportDate) }}</td>
        <td class="report-location">
          Piso {{ report.floorId }}
          <span *ngIf="report.roomId">, Sala {{ report.roomId }}</span>
          <span *ngIf="report.workstationId">, Estación {{ report.workstationId }}</span>
        </td>
        <td class="report-status">
                            <span class="status-badge" [ngClass]="statusClasses[report.status]">
                              {{ statusLabels[report.status] }}
                            </span>
        </td>
        <td class="report-actions">
          <div class="action-buttons">
            <button class="action-btn view-btn" (click)="verDetalleReporte(report.reportId)">
              <i class="fas fa-eye"></i>
            </button>
            <div class="dropdown-wrapper">
              <button class="action-btn status-btn" (click)="toggleStatusMenu(report.reportId)">
                <i class="fas fa-exchange-alt"></i>
              </button>
              <div class="status-dropdown" *ngIf="activeDropdown === report.reportId">
                <button class="status-option pending" (click)="updateStatus(report, 'pending')">
                  Pendiente
                </button>
                <button class="status-option in-progress" (click)="updateStatus(report, 'in_progress')">
                  En progreso
                </button>
                <button class="status-option resolved" (click)="updateStatus(report, 'resolved')">
                  Resuelto
                </button>
              </div>
            </div>
          </div>
        </td>
      </tr>
      </tbody>
    </table>
  </div>
</div>
